<include file="public@header"/>
</head>
<style>
    #status{    width: 100px;
        height: 32px;
        border-color: #dce4ec;
        color: #aeb5bb;}
</style>
<body>
<div class="wrap js-check-wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a href="javascript:;">{:lang('通话列表')}</a></li>
    </ul>
    <form class="well form-inline margin-top-20" method="post" action="{:url('VideoCallList/record')}">
        {:lang('USER_ID')}：
        <input class="form-control" type="text" name="uid" style="width: 200px;" value="{$requery['uid']|default=''}"
               placeholder="{:lang('USER_ID')}">
        {:lang('ADMIN_ANCHOR_ID')}：
        <input class="form-control" type="text" name="host" style="width: 200px;" value="{$requery['host']|default=''}"
               placeholder="{:lang('USER_ID')}">
        {:lang('STATUS')}：
        <select name="status" id="status" >
            <option value="-1" >{:lang('ALL')}</option>
            <option value="1" <if condition="$requery['status'] eq 1"> selected="selected" </if> >{:lang('通话中')}</option>
            <option value="2" <if condition="$requery['status'] eq 2"> selected="selected" </if>  >{:lang('通话拒绝')}</option>
            <option value="3" <if condition="$requery['status'] eq 3"> selected="selected" </if>  >{:lang('通话挂断')}</option>
            <option value="4" <if condition="$requery['status'] eq 4"> selected="selected" </if>  >{:lang('通话超时')}</option>

        </select>
        {:lang('TIME')}:
        <input type="text" class="form-control js-bootstrap-date" name="start_time" value="{$requery['start_time']|default=''}" style="width: 140px;" autocomplete="off">-
        <input type="text" class="form-control js-bootstrap-date" name="end_time" value="{$requery['end_time']|default=''}" style="width: 140px;" autocomplete="off"> &nbsp; &nbsp;
        <input type="submit" class="btn btn-primary" value="{:lang('SEARCH')}"/>
        <a class="btn btn-danger" href="{:url('VideoCallList/record')}">{:lang('EMPTY')}</a>
    </form>
    <form class="js-ajax-form" action="{:url('refill/upd')}" method="post">

        <table class="table table-hover table-bordered table-list">
            <thead>
            <tr>
                <th>ID</th>
                <th>{:lang('USER_NICKNAME')}(ID)</th>
                <th>{:lang('ADMIN_ANCHOR_NICKNAME')}(ID)</th>
                <th>{:lang('频道ID')}</th>
                <th>{:lang('STATUS')}</th>
                <th>{:lang('拨打时间')}</th>
                <th>{:lang('ADMIN_ACTIVITY_MSG_END_TIME')}</th>
                <th>{:lang('通话时长(秒)')}</th>
               <!--  <th>{:lang('是否点赞')}</th>
                <th>{:lang('是否是免费试用')}</th> -->
                <th>{:lang('ACTIONS')}</th>
            </tr>
            </thead>
            <PHP>
                $is_fabulous=array('1'=>lang('YES'),'0'=>lang('NO'));
                $is_free=array('1'=>lang('YES'),'0'=>lang('NO'));
            </PHP>
            <tfoot>
            <foreach name="list" id="vo">
                <tr>
                    <td>{$vo.id}</td>
                    <td>{$vo['user_info']['user_nickname']}({$vo['user_info']['id']})</td>
                    <td>{$vo['emcee_info']['user_nickname']}({$vo['emcee_info']['id']})</td>
                    <td>{$vo.channel_id}</td>
                    <if condition="$vo['status'] eq 1">
                        <td>{:lang('通话中')}</td>
                    <elseif condition="$vo['status'] eq 2"/>
                        <td>{:lang('通话拒绝')}</td>
                    <elseif condition="$vo['status'] eq 3"/>
                        <td>{:lang('通话挂断')}</td>
                    <elseif condition="$vo['status'] eq 4"/>
                        <td>{:lang('通话超时')}</td>
                    <else/>
                        <td>{:lang('等待接通')}</td>
                    </if>
                    <td>{$vo.create_time | date="Y-m-d H:i:s",###}</td>
                    <td>{$vo.end_time | date="Y-m-d H:i:s",###}</td>
                    <td>{$vo.call_time}</td>
                  <!--   <td>{$is_fabulous[$vo.is_fabulous]}</td>
                    <td>{$is_free[$vo.is_free]}</td> -->
                    <td><a href="#" onclick="select_video('{:url(\'video_call_list/select_details\')}?id={$vo.id}')">{:lang('查看详情')}</a></td>

                </tr>
            </foreach>
            </tfoot>
        </table>
        <div class="pagination">{$page}</div>
    </form>
</div>
<script src="__STATIC__/js/layer/layer.js" rel="stylesheet"></script>
<script src="__STATIC__/js/admin.js"></script>
<script>

    function select_video(id){
        layer.open({
            type: 2,
            title: "{:lang('查看详情')}",
            shadeClose: true,
            shade: 0.8,
            area: ['90%', '90%'],
            content: id //iframe的url  '/admin/public/admin/video_call_list/select_details/id/'
        });
    }

    $(".btn-primary").click(function(){
        $(".js-ajax-form").submit();
    })
</script>
</body>
</html>