<include file="public@header"/>
<style>
    .gift-img {
        width: 50px;
        height: 50px
    }

    .gift-img img {
        width: 100%;
        height: 100%;
    }


    .select{width: 150px;height:30px;}
    .js-ajax-form {
        margin-top: 30px;
    }
</style>
</head>
<body>
<div class="wrap js-check-wrap">
    <ul class="nav nav-tabs">
        <li class="active"><a href="javascript:;">{:lang('ADMIN_AWARD_GIFT_LIST')}</a></li>
    </ul>
    <form class="well form-inline margin-top-20" method="post" action="{:url('GameBox/eggs_log')}" id="myForm">
        {:lang('USER_ID')}:
        <input type="text" class="form-control" name="uid" style="width: 120px;" value="{$request['uid']|default=''}" placeholder="{:lang('USER_ID')}">

        {:lang('ADMIN_GIFT')}:
        <select class="select" name="gift_id">
            <option val="0">{:lang('ALL')}</option>
            <foreach name="gift" item="vo">
                <option value="{$vo['id']}" <if condition="$request['gift_id'] eq $vo['id']"> selected = "selected" </if>>{$vo['name']}</option>
            </foreach>
        </select>
       {:lang('宝箱类型')}:
        <select class="select" name="box_id">
            <option val="0">{:lang('ALL')}</option>
            <foreach name="game_box" item="vo">
                <option value="{$vo['id']}" <if condition="$request['box_id'] eq $vo['id']"> selected = "selected" </if>>{$vo['name']}</option>
            </foreach>
        </select>
       {:lang('房间ID')}:
        <input type="text" class="form-control" name="voice_id" style="width: 120px;" value="{$request['voice_id']|default=''}" placeholder="{:lang('房间ID')}">
       {:lang('礼物奖池')}ID:
        <input type="text" class="form-control" name="pool_id" style="width: 120px;" value="{$request['pool_id']|default=''}" placeholder="{:lang('礼物奖池')}">
       {:lang('轮回次数')}:
        <input type="text" class="form-control" name="cycles" style="width: 120px;" value="{$request['cycles']|default=''}" placeholder="{:lang('轮回次数')}">

        <div style="margin-top: 15px;">
           {:lang('次数标识')}:
            <input type="text" class="form-control" name="only" style="width: 250px;" value="{$request['only']|default=''}" placeholder="{:lang('次数标识')}">
            {:lang('TIME')}:
            <input type="text" class="form-control js-bootstrap-date" name="start_time" value="{$request['start_time']|default=''}" style="width: 140px;" autocomplete="off">-
            <input type="text" class="form-control js-bootstrap-date" name="end_time" value="{$request['end_time']|default=''}" style="width: 140px;" autocomplete="off"> &nbsp; &nbsp;

            <a class="btn btn-success" onclick="editAndSubmitForm('day')">{:lang('今日')}</a>
            <a class="btn btn-info" onclick="editAndSubmitForm('yesterday')">{:lang('昨日')}</a>
            <a class="btn btn-warning" onclick="editAndSubmitForm('week')">{:lang('本周')}</a>
            <a class="btn btn-danger" onclick="editAndSubmitForm('last_week')">{:lang('上周')}</a>
            <input type="submit" class="btn btn-primary" value="{:lang('SEARCH')}" />
            <a class="btn btn-danger" href="{:url('GameBox/eggs_log')}">{:lang('EMPTY')}</a>
        </div>


    </form>
    <div style="margin-top:10px;">
        <span>{:lang('ADMIN_COMMISSION_COIN')}: {$Statistics.coin_money}</span>
        <span>{:lang('总奖励金额')}: {$Statistics.gift_money}</span>
    </div>
    <div style="color:red">
        <span>{:lang('统计：')}</span>
        <foreach name="count" id="c">
            <span style="margin-right: 20px">
                {$c.name}: {$c.sum}{:lang('个')}
            </span>
        </foreach>
    </div>
    <table class="table table-hover table-bordered table-list">
        <thead>
        <tr>
            <th>{:lang('USER')}(ID)</th>
            <th>{:lang('ADMIN_GIFT_NAME')}</th>
            <th>{:lang('ADMIN_GIFT_NUM')}</th>
            <th>{:lang('宝箱类型')}</th>
            <th>{:lang('ADMIN_TIMES_ID')}</th>
            <th>{:lang('房主(房间ID/房主ID)')}</th>
            <th>{:lang('奖励轮回次数')}</th>
            <th>{:lang('奖池id')}</th>
            <th>{:lang('备注')}</th>
            <th>{:lang('TIME')}</th>
        </tr>
        </thead>
        <tfoot>
        <php>

            $trigger_bonus_amount=lang('触发大奖限制');// 触发奖金额
            $voice_game_box_coin=lang('开奖前剩余金额');// 本次开奖前剩余总金额
            $voice_game_box_new_coin=lang('结束奖池剩余');// 本次开奖后剩余总金额
            $prize_coin=lang('中奖礼物价值');// 中奖总金币
            $is_award_status = lang('是否已出大奖');// 是否已出大奖 0未出 1已出
        </php>



        <foreach name="list" id="vo">
            <tr>
                <td>{$vo.user_nickname}({$vo.uid})</td>
                <td>
                    <if condition="$vo['is_grand_prix'] == 1">
                        <div style="color:#2eb90b">{$vo.gift}</div>
                        <else/>
                        <div>{$vo.gift}</div>
                    </if>
                </td>
                <td>{$vo.sum}</td>
                <td>{$vo.box_name}({$vo.box_id})</td>
                <td>{$vo.only}</td>
                <td>{$vo.aname}({$vo.voice_id} / {$vo.voice_user_id})</td>
                <td>{$vo.cycles}</td>
                <td>{$vo.pool_id}</td>
                <td>
                    <if condition="$vo.pool_json">
                        <div>{$trigger_bonus_amount}: {$vo['pool_json']['trigger_bonus_amount']}</div>
                        <div>{$voice_game_box_coin}: {$vo['pool_json']['voice_game_box_coin']}</div>
                        <div>{$voice_game_box_new_coin}: {$vo['pool_json']['voice_game_box_new_coin']}</div>
                        <div>{$prize_coin}: {$vo['pool_json']['prize_coin']}</div>
                        <if condition="isset($vo['pool_json']['is_award_status'])">
                            <if condition="$vo['pool_json']['is_award_status'] == 1">
                                <div>{$is_award_status}: <span style="color:#2eb90b">{:lang('已出')}</span></div>
                                <else/>
                                <div>{$is_award_status}: <span style="color:#f14343">{:lang('未出')}</span></div>
                            </if>
                        </if>
                        <if condition="isset($vo['pool_json']['pool_difference'])">
                            <if condition="$vo['pool_json']['pool_difference']">
                                <div>{:lang('距离触发大奖还差')}: {$vo['pool_json']['pool_difference']}</div>
                            </if>
                        </if>
                    </if>
                </td>
                <td>{$vo.addtime | date="Y-m-d H:i:s",###}</td>
            </tr>
        </foreach>
        </tfoot>
    </table>
    <div class="pagination">{$page}</div>
</div>
<script src="__STATIC__/js/admin.js"></script>
<script>
    function editAndSubmitForm(val) {
        // 获取表单的引用
        const form = document.getElementById('myForm');
        const inputElement = document.createElement("input");
        inputElement.type = "text";
        inputElement.name = "date_type";
        inputElement.value = val;
        form.append(inputElement); // 将新的input元素添加到fieldset中
        // 提交表单
        form.submit();
    }
</script>
</body>
</html>
